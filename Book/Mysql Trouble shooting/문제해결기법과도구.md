## 6.5.5 Show [Global] Status

* 상태변수는 전역변수와 세션변수로 나뉜다. 
	* 클라이언트가 연결 될 때 세션변수는 0으로 설정되고, 전역변수는 서버가 시작한 후 가장 최근에 Flush Status 명령을 실행한 이후의 상태를 보여준다.

* 상태변수로 문제를 해결할 때는 변수 값을 한 번만 확인하지 않아야 한다. -> 시간이 지나면서 바뀌는 추이를 보아야한다. 값이 크고 빠르게 증가하고 있다면 어떤 문제가 있음을 암시한다.

* 상태변수의 종류
	* Com_* 변수
		* 종류별로 명령이 내려진 쿼리의 개수를 가지고 있다. Com_select는 select 명령의 실행 횟수를 알 수 있다. 이 변수는 서버에 어떤 부하가 걸리는지 간략히 보여준다. 예를 들어 Com_insert의 값이 크다면 거기에 맞춰 설정을 조정해야 한다.
	* Handler_*,Select_*,Sort_* 변수
		* Handler_*: 쿼리가 실행될 때 테이블 내부에 어떤일이 일어나는지 알려준다. Handler_delete변수는 삭제된 행의 개수를 알려준다. 사이즈가 큰 테이블의 DELETE 진행 상태를 파악할 수 있다.
		* Select_*: 조인 방법별로 사용된 횟수를 알 수 있다.
		* Sort_*: 정렬에 대한 변수 정보를 알 수 있다.
	* Innodb_* 변수
		* Innodb 스토리지 엔진의 내부 상태를 알려준다. 다양한 연구가 필요함
	* Performance_schema_* 변수
		* 서버나 스토리지 엔진의 소스코드에서 측정위치가 정의된 객체에 대한 정보를 알려준다. 
	* SSL_* 변수
		* SSL 연결에 대한 정보
	* *open*, *close* 변수
		* 종류별로 사용하거나 생성한 객체들의 개수를 알 수 있다.
		
# 6.7 문제를 해결하는 일반적인 단계

* 문제를 일으키는 실제 쿼리를 찾아낸다
* 쿼리 문법을 확인한다.
* 쿼리에 문제가 있는지 확인한다.
* 쿼리가 예상과 다른 데이터를 반환한다면 올바를 결과를 반환하도록 수정한다.
* 쿼리를 수정해도 원인을 찾지 못한다면 서버옵션을 검사하고, 서버 옵션이 결과에 영향을 주는지 알아본다. 이 때 쿼리를 단순화한 후 설정을 변경하는 것이 좋다.
* 쿼리에 문제가 없다고 확인되면 쿼리가 처리하는 데이터를 처리하거나 손상시킨 문장이나 작업으로 거슬러 올라간다.
* Mysql CLI에서 문제가 재현되지 않으면 동시성 문제를 조사한다.
* 크래시되거나 멈추는 현상이 발생하면 에러로그 파일을 먼저 검사한다.
* 에러로그 파일에서 아무런 단서를 찾을 수 없다면 크래시 직전에 수행한 쿼리를 찾는다.
* 장애가 발생하는 서버에 mysql-debug를 실행해 생성된 코어 덤프파일을 분석한다.
* 설정 옵션을 분석하고 조정한다.
* mysql에 영향을 줄 수 있는 외부 프로세스를 찾아내기 위해 운영체제 도구를 사용한다.
